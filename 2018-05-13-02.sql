

SELECT TOP 100 * FROM SORDER
SELECT TOP 100 * FROM SORDERP
SELECT TOP 100 * FROM SORDERQ

--SELECT TOP 100 * FROM SDELIVERYD
--SELECT TOP 100 * FROM SDELIVERY
--SELECT TOP 100 * FROM APLSTD WHERE LAN_0 = N'CHI' AND LANCHP_0 = N'1'
--SELECT * FROM AUTILIS



--SELECT T1.CREDAT_0,
--		T1.SDHNUM_0,
--		T4.NOMUSR_0,
--		T3.LANMES_0,
--		T2.BPINAM_0,
--		T1.ITMREF_0,
--		T1.ITMDES_0,
--		T1.QTY_0,
--		T1.NETPRIATI_0,
--		T1.NETPRIATI_0 * T1.QTY_0 PRICE,
--		T1.SOHNUM_0
--FROM SDELIVERYD T1
--	LEFT JOIN SDELIVERY T2 ON T1.SDHNUM_0 = T2.SDHNUM_0
--	LEFT JOIN APLSTD T3 ON T2.CFMFLG_0 = T3.LANNUM_0 AND T3.LAN_0 = N'CHI' AND T3.LANCHP_0 = N'1'
--	LEFT JOIN AUTILIS T4 ON T1.CREUSR_0 = T4.USR_0
--WHERE T1.STOFCY_0 = N'0102'
--	AND T1.CREDAT_0 BETWEEN N'2018-01-01' AND N'2018-02-01'
--ORDER BY T1.SDHNUM_0


--SELECT * FROM BPCUSTOMER WHERE BPCNUM_0 LIKE N'YN%'
--SELECT * FROM PORDERQ WHERE PRHFCY_0 = N'0301' AND BPSNUM_0 = N'YN-002' GROUP BY POHNUM_0
--SELECT * FROM SORDERQ WHERE SALFCY_0 = N'0201' AND BPCORD_0 = N'YN-007' GROUP BY SOHNUM_0,POHNUM_0
SELECT ITMREF_0,COUNT(ITMREF_0) FROM SORDERQ WHERE SALFCY_0 = N'0201' AND BPCORD_0 = N'YN-007' GROUP BY ITMREF_0 ORDER BY COUNT(ITMREF_0) DESC

--SELECT * FROM SORDERQ WHERE SOHNUM_0 IN(N'0201SOH18040256',N'0201SOH18040268')

--SELECT *
--FROM SORDERQ T1
--	INNER JOIN PORDERQ T2 ON T1.POHNUM_0 = T2.POHNUM_0 AND T1.POPLIN_0 = T2.POPLIN_0
--WHERE T1.SALFCY_0 = N'0201' AND BPCORD_0 = N'YN-007'
--	AND T2.PRHFCY_0 = N'0301' AND T2.BPSNUM_0 = N'YN-002'
--SELECT * FROM SORDER WHERE SOHNUM_0 = N'0201SOH18040268'
--SELECT * FROM SORDERQ WHERE SOHNUM_0 = N'0201SOH18040268'
--SELECT * FROM SORDERP WHERE SOHNUM_0 = N'0201SOH18040256'

--SELECT * FROM SORDERQ WHERE SOHNUM_0 = N''
--UPDATE SORDERQ SET SOHNUM_0 = '0201SOH18040256',SOPLIN_0 = SOQSEQ_0 WHERE SOHNUM_0 = N''
--UPDATE SORDER SET BETFCY_0 = 1 WHERE SOHNUM_0 = N'0201SOH18040268'
--UPDATE SORDER SET BETCPY_0 = 1 WHERE SOHNUM_0 = N'0201SOH18040268'
--UPDATE SORDER SET CUSORDREF_0 = N'' WHERE SOHNUM_0 = N'0201SOH18040268'
--UPDATE SORDERQ SET POHNUM_0 = N'', POPLIN_0 = N'' WHERE SOHNUM_0 = N'0201SOH18040268'
--UPDATE SORDER SET BPCORD_0 = N'CHN-SH-4430',BPCINV_0 = N'CHN-SH-4430',BPCPYR_0 = N'CHN-SH-4430',BPCGRU_0 = N'CHN-SH-4430' WHERE SOHNUM_0 = N'0201SOH18040268'
--UPDATE SORDER SET SOHNUM_0 = N'0201SOH18040268' WHERE SOHNUM_0 = N'0201SOH18050069'
--UPDATE SORDERQ SET SOHNUM_0 = N'0201SOH18040268' WHERE SOHNUM_0 = N'0201SOH18050069'
--UPDATE SORDERP SET SOHNUM_0 = N'0201SOH18040268' WHERE SOHNUM_0 = N'0201SOH18050069'
--UPDATE SORDERC SET SOHNUM_0 = N'0201SOH18040268' WHERE SOHNUM_0 = N'0201SOH18050069'

--DELETE FROM SORDER WHERE SOHNUM_0 = N'0201SOH18040268'
--DELETE FROM SORDERQ WHERE SOHNUM_0 = N'0201SOH18040268'
--DELETE FROM SORDERP WHERE SOHNUM_0 = N'0201SOH18040268'


--SELECT * FROM PORDERQ WHERE ITMREF_0 = N'SICN0058'






SELECT TOP 100 * FROM SORDERQ WHERE SALFCY_0 = N'0101'
SELECT TOP 100 * FROM SORDER WHERE SALFCY_0 = N'0101'
SELECT TOP 100 * FROM SORDERP WHERE SALFCY_0 = N'0101'
SELECT TOP 100 * FROM APLSTD WHERE LANCHP_0 = N'250'
SELECT TOP 100 * FROM MFGITM
SELECT  
		T2.CREDAT_0,
		T2.DEMDLVDAT_0,
		T3.SOHNUM_0,
		T1.POHNUM_0,
		T2.SOHNUM_0,
		T11.MFGNUM_0,
		T2.BPCORD_0,
		T4.BPCNAM_0,
		T5.ITMREF_0,
		T5.ITMDES1_0,
		T2.QTY_0,
		T10.LANMES_0,
		T6.CUR_0,
		ISNULL(T7.NETPRI_0,T8.NETPRI_0),
		ISNULL(T7.NETPRI_0,T8.NETPRI_0) * T2.QTY_0 LINORDATI_0,
		T2.SOQSTA_0,
		T2.DLVQTY_0,
		T2.SOQSTA_0 - T2.DLVQTY_0 UNDLVQTY_0,
		T3.ZRMK_0
FROM PORDERQ T1
	LEFT JOIN SORDERQ T2 ON T1.POHNUM_0 = T2.POHNUM_0 AND T1.POPLIN_0 = T2.POPLIN_0
	LEFT JOIN SORDERQ T3 ON T1.POHNUM_0 = T3.FMINUM_0 AND T1.POPLIN_0 = T3.FMILIN_0
	LEFT JOIN BPCUSTOMER T4 ON T3.BPCORD_0 = T4.BPCNUM_0
	LEFT JOIN ITMMASTER T5 ON T2.ITMREF_0 = T5.ITMREF_0
	LEFT JOIN SORDER T6 ON T2.SOHNUM_0 = T6.SOHNUM_0
	LEFT JOIN SORDERP T7 ON T3.SOHNUM_0 = T7.SOHNUM_0 AND T3.SOPLIN_0 = T7.SOPLIN_0
	LEFT JOIN SORDERP T8 ON T2.SOHNUM_0 = T8.SOHNUM_0 AND T2.SOPLIN_0 = T8.SOPLIN_0
	LEFT JOIN ITMFACILIT T9 ON T2.ITMREF_0 = T9.ITMREF_0 AND T9.STOFCY_0 = N'0301'
	LEFT JOIN APLSTD T10 ON T9.REOCOD_0 = T10.LANNUM_0 AND T10.LANCHP_0 = N'250' AND T10.LAN_0 = N'CHI'
	LEFT JOIN MFGITM T11 ON T2.SOHNUM_0 = T11.VCRNUMORI_0 AND T2.SOPLIN_0 = T11.VCRLINORI_0
WHERE  T1.POHNUM_0 = N'0101POH18050265'
AND T2.CREDAT_0 BETWEEN %1% AND %2%


SELECT * FROM SORDERP WHERE SOHNUM_0 = N'0101SOH18050082' AND ITMREF_0 = N'ISQ0053-08'




SELECT * FROM WECHATAUTH

INSERT INTO WECHATAUTH(USERID_0,DIMENSION_0,FCY_0,CREDATTIM_0,UPDDATTIM_0,AUUID_0,CREUSR_0,UPDUSR_0)
		VALUES(N'ocwHT0yHEKfRw39oKIPWIYAvWM_Q',N'SOP',N'0101',GETDATE(),GETDATE(),NEWID(),N'ADMIN',N'ADMIN')

SELECT TOP 100 * FROM SINVOICED
SELECT T1.NUM_0,
		T1.SIDLIN_0,
		T2.SOHNUM_0,
		T2.SOPLIN_0,
		T2.VAT_0,
		T2.CREUSR_0
FROM SINVOICED T1
	LEFT JOIN SORDERP T2 ON T1.SOHNUM_0 = T2.SOHNUM_0 AND T1.SOPLIN_0 = T2.SOPLIN_0
WHERE NUM_0 = N'0101SIH18050028'

SELECT T1.ITMREF_0,
		T2.ITMDES1_0,
		T2.STU_0,
		SAFSTO_0 
FROM ITMFACILIT T1
	LEFT JOIN ITMMASTER T2 ON T1.ITMREF_0 = T2.ITMREF_0
WHERE STOFCY_0 = N'0203'

SELECT T1.REOCOD_0,
		T1.ITMREF_0
FROM (SELECT * FROM ITMFACILIT WHERE STOFCY_0 = N'0501') T1
	LEFT JOIN (SELECT * FROM ITMFACILIT WHERE STOFCY_0 = N'0201')T2 ON T1.ITMREF_0 = T2.ITMREF_0
WHERE T1.REOCOD_0 <> T2.REOCOD_0

UPDATE T1 SET T1.REOCOD_0 = T2.REOCOD_0
FROM (SELECT * FROM ITMFACILIT WHERE STOFCY_0 = N'0501') T1
	LEFT JOIN (SELECT * FROM ITMFACILIT WHERE STOFCY_0 = N'0201')T2 ON T1.ITMREF_0 = T2.ITMREF_0
WHERE T1.REOCOD_0 <> T2.REOCOD_0


SELECT A.STOFCY_0 as 地点,
  A.ITMREF_0 as 产品,
  X.ITMDES1_0 as 名称,
  A.REOCOD_0 AS 建议类型,
  B.QTY1_0 as 仓库库存,
  C.QTY2_0 as 车间库存,
  D.QTY3_0 AS 其他库存,
  E.ALLQTY1_0 as 订单分配数量,
  F.ALLQTY2_0 AS 工单分配数量,
  G.ALLQTY3_0 AS 发货中数量,
  H.POHQTY_0 AS 采购中数量,
  I.MFGQTY_0 AS 工单短缺量,
  J.SOHQTY_0 AS 订单短缺量
FROM ITMFACILIT A
 LEFT JOIN ITMMASTER X ON A.ITMREF_0 = X.ITMREF_0
 LEFT JOIN (SELECT STOFCY_0,ITMREF_0,SUM(QTYSTU_0 - CUMALLQTY_0) AS QTY1_0 from STOCK WHERE LOC_0 IN ('M01','M02','M03') GROUP BY STOFCY_0,ITMREF_0) B ON A.ITMREF_0 = B.ITMREF_0 AND A.STOFCY_0 = B.STOFCY_0
 LEFT JOIN (SELECT STOFCY_0,ITMREF_0,SUM(QTYSTU_0 - CUMALLQTY_0) AS QTY2_0 from STOCK WHERE LOC_0 = 'M04' GROUP BY STOFCY_0,ITMREF_0) C ON A.ITMREF_0 = C.ITMREF_0 AND A.STOFCY_0 = C.STOFCY_0
 LEFT JOIN (SELECT STOFCY_0,ITMREF_0,SUM(QTYSTU_0 - CUMALLQTY_0) AS QTY3_0 from STOCK WHERE LOC_0 NOT IN ('M01','M02','M03','M04') GROUP BY STOFCY_0,ITMREF_0) D ON A.ITMREF_0 = D.ITMREF_0 AND A.STOFCY_0 = D.STOFCY_0
 LEFT JOIN (SELECT STOFCY_0,ITMREF_0,SUM(QTYSTU_0) AS ALLQTY1_0 FROM STOALL WHERE VCRTYP_0 = 2 GROUP BY STOFCY_0,ITMREF_0) E ON A.ITMREF_0 = E.ITMREF_0 AND A.STOFCY_0 = E.STOFCY_0
 LEFT JOIN (SELECT STOFCY_0,ITMREF_0,SUM(QTYSTU_0) AS ALLQTY2_0 FROM STOALL WHERE VCRTYP_0 = 10 GROUP BY STOFCY_0,ITMREF_0) F ON A.ITMREF_0 = F.ITMREF_0 AND A.STOFCY_0 = F.STOFCY_0
 LEFT JOIN (SELECT STOFCY_0,ITMREF_0,SUM(QTYSTU_0) AS ALLQTY3_0 FROM STOALL WHERE VCRTYP_0 not in (2,10) GROUP BY STOFCY_0,ITMREF_0) G ON A.ITMREF_0 = G.ITMREF_0 AND A.STOFCY_0 = G.STOFCY_0
 LEFT JOIN (SELECT POHFCY_0,ITMREF_0,SUM(QTYSTU_0 - RCPQTYSTU_0) AS POHQTY_0 FROM PORDERQ where LINCLEFLG_0 = 1 GROUP BY POHFCY_0,ITMREF_0) H ON A.ITMREF_0 = H.ITMREF_0 AND A.STOFCY_0 = H.POHFCY_0
 LEFT JOIN (SELECT MFGFCY_0,ITMREF_0,SUM(RETQTY_0 - USEQTY_0 - ALLQTY_0) AS MFGQTY_0 FROM MFGMAT WHERE MATSTA_0 NOT IN(3,4) AND MFGSTA_0 <> 4 GROUP BY MFGFCY_0,ITMREF_0) I ON A.ITMREF_0 = I.ITMREF_0 AND A.STOFCY_0 = I.MFGFCY_0
 LEFT JOIN (select SALFCY_0,ITMREF_0,SUM(QTY_0 - ALLQTY_0 - DLVQTY_0) AS SOHQTY_0 from SORDERQ WHERE SOQSTA_0 <> 3 GROUP BY SALFCY_0,ITMREF_0) J ON A.ITMREF_0 = J.ITMREF_0 AND A.STOFCY_0 = J.SALFCY_0
 WHERE A.STOFCY_0 = N'0301'
ORDER BY A.STOFCY_0,A.ITMREF_0



SELECT * FROM PORDERP WHERE POHNUM_0 = N'0201POH18040182'

SELECT * FROM WECHATACTO
SELECT * FROM AUTILIS
SELECT USR_0,NOMUSR_0 FROM AUTILIS WHERE NOMUSR_0 LIKE N'%博文%'
SELECT TOP 1 ACCESSTOKEN_0,DATEDIFF(SECOND,CREDATTIM_0,GETDATE()) EXPIRE FROM WECHATACTO ORDER BY CREDATTIM_0 DESC
DELETE FROM WECHATACTO
SELECT * FROM WECHATUSER
SELECT TOP 1 ACCESSTOKEN_0,DATEDIFF(SECOND,CREDATTIM_0,GETDATE()) EXPIRE FROM WECHATACTO ORDER BY CREDATTIM_0 DESC
INSERT INTO WECHATACTO(ACCESSTOKEN_0,CREDATTIM_0,UPDDATTIM_0,AUUID_0,CREUSR_0,UPDUSR_0) VALUES(N'',GETDATE(),GETDATE(),NEWID(),N'ADMIN',N'ADMIN')

INSERT INTO WECHATACTO(ACCESSTOKEN_0,CREDATTIM_0,UPDDATTIM_0,AUUID_0,CREUSR_0,UPDUSR_0) 
			VALUES(N'9_3sz1IRS8wE-Oj6etYAgrb-2oudy-1wzAgxtOhMCChZen0sW_XgpCkWMe3eZZz0Zz7Z4b7DLaB8DE-FIhupu-RY91ZwR0M6uIRc-l5tIXp9dSzzq_D7tRH9Zao9RsfjGYKsSYgz5zV1g2NuV0HNNhAJAYEE',GETDATE(),GETDATE(),NEWID(),N'ADMIN',N'ADMIN')




SELECT * FROM STOJOU WHERE ITMREF_0 = N'ICN0008-01' AND CREDAT_0 BETWEEN N'2018-05-10' AND N'2018-05-11'


SELECT * FROM ORDERS WHERE VCRNUM_0 = N'0201SOH18040256'

DELETE  FROM ORDERS WHERE VCRNUM_0 = N'0201SOH18040256'



