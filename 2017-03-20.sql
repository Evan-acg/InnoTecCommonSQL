--SELECT * FROM ITMFACILIT WHERE ITMREF_0 = 'IZT8070'



--SELECT * FROM SDELIVERYD WHERE SDHNUM_0 = '0101SDH17010003'
--SELECT * FROM SDELIVERY WHERE SDHNUM_0 = '0101SDH16110002'
--SELECT * FROM PRECEIPTD WHERE PTHNUM_0 = '0203REC17010015'
--SELECT TOP 10 * FROM PRECEIPT
--SELECT * FROM GACCENTRY WHERE NUM_0 = '01011701STOCK000347'
--SELECT * FROM GACCENTRYD WHERE NUM_0 = '02011701STOCK000028'

--SELECT SDHNUM_0,COUNT(SDHNUM_0) FROM SDELIVERYD GROUP BY SDHNUM_0

--SELECT * FROM PORDER WHERE POHNUM_0 = '0101POH17030500'

--SELECT T1.NUM_0 AS N'凭证号',
--		T1.CREDAT_0 AS N'制单日期',
--		T1.DESVCR_0 AS N'摘要',
--		T3.AMTCUR_0 AS N'金额',
--		T2.*
--FROM GACCENTRY T1
--	LEFT JOIN (
--				SELECT NUM_0,
--						SNS_0,
--						SUM(AMTCUR_0)AS AMTCUR_0 
--				FROM GACCENTRYD 
--				GROUP BY NUM_0,SNS_0
--				) T3 ON T1.NUM_0 = T3.NUM_0 AND T3.SNS_0 = 1 
--	RIGHT JOIN (
--				SELECT BPONAM_0 AS N'客户名称',
--						PTHNUM_0 AS N'编号',
--						CREDAT_0 AS N'制单日期',
--						TOTLINQTY_0 AS N'数量',
--						TOTLINAMT_0 AS N'金额',
--						N'收货单'AS N'来源'
--				FROM PRECEIPT
--				WHERE PRHFCY_0 <> '0101' AND RCPDAT_0 BETWEEN '2017-01-01' AND '2017-01-31'
--				UNION ALL
--				SELECT BPINAM_0 AS N'客户编码',
--						SDHNUM_0 AS N'编号',
--						CREDAT_0 AS N'制单日期',
--						DSPTOTQTY_0 AS N'数量',
--						DLVNOT_0 AS N'金额',
--						N'发货单'AS N'来源'
--				FROM SDELIVERY
--				WHERE SALFCY_0 = '0101' AND DLVDAT_0 BETWEEN '2017-01-01' AND '2017-01-31'
--					) T2 ON T1.BPRVCR_0 = T2.编号

--SELECT * FROM SDELIVERYD WHERE SOHNUM_0 = '0101SOH17020187' AND ITMREF_0 = 'MCU0019'

--SELECT T1.SOHNUM_0 AS N'销售订单',
--		T1.SOPLIN_0 / 1000 AS N'行号',
--		T1.ITMREF_0 AS N'产品',
--		T2.ITMDES_0 AS N'产品名称',
--		T1.BPCORD_0 AS N'客户',
--		(SELECT BPCNAM_0 FROM BPCUSTOMER WHERE BPCNUM_0 = T1.BPCORD_0) AS N'客户名称',
--		T1.UPDDATTIM_0 AS N'订单日期',
--		T1.CREDATTIM_0 AS N'创建日期',
--		T1.SHIDAT_0 AS N'交期',
--		T1.QTY_0 AS N'数量',
--		T1.DLVQTY_0 AS N'已发货日期',
--		T1.INVQTY_0 AS N'已开票数量',
--		T2.NETPRI_0 AS N'单价',
--		(T1.QTY_0 * T2.NETPRI_0) AS N'金额',
--		T6.CUR_0 AS N'币种',
--		T1.ZRMK_0 AS N'备注',
--		T1.ZCUSNUM_0 AS N'客户订单号',
--		T1.ZCUSNUMLIN_0 AS N'客户订单行号', 
--		T3.NOMUSR_0 AS N'创建用户',
--		T1.FMI_0 AS N'发货方式',
--		T4.ITMDESBPC_0 AS N'客户产品号',
--		T5.XSOHNUM_0 AS N'内部订单号',
--		T5.XSOPLIN_0 / 1000 AS N'内部订单行号'
--FROM SORDERQ T1
--	LEFT JOIN SORDERP T2 ON T1.SOHNUM_0 = T2.SOHNUM_0 AND T1.SOPLIN_0 = T2.SOPLIN_0
--	LEFT JOIN AUTILIS T3 ON T1.CREUSR_0 = T3.USR_0
--	LEFT JOIN ITMBPC T4 ON T1.ITMREF_0 = T4.ITMREF_0
--	LEFT JOIN ZSOYN T5 ON T1.SOHNUM_0 = T5.SOHNUM_0 AND T1.SOPLIN_0 = T5.SOPLIN_0
--	LEFT JOIN SORDER T6 ON T1.SOHNUM_0 = T6.SOHNUM_0
--ORDER BY T5.SOHNUM_0,T5.XSOPLIN_0

--SELECT * FROM SORDERQ
--SELECT * FROM SDELIVERY

--SELECT T1.CREDAT_0 AS N'制单日期',
--		  T3.ZCUSNUM_0 AS N'客户订单号',
--		  T3.ZCUSNUMLIN_0 AS N'客户订单行号',
--		  T1.SDHNUM_0 AS N'发货单号',
--		  T4.BPCNAM_0 AS N'客户名称',
--		  T1.SOHNUM_0 AS N'销售单号',
--		  T4.BPCORD_0 AS N'客户代码',
--		  T1.ITMREF_0 AS N'产品代码',
--		  T1.ITMDES1_0 AS N'产品名称',
--		  T1.STU_0 AS N'产品单位',
--		  T1.QTY_0 AS N'发货数量',
--		  T3.QTY_0 AS N'订单数量',
--		  T1.GROPRI_0 AS N'单价',
--		  (T1.QTY_0 * T1.GROPRI_0) AS N'金额',
--		  T3.ZRMK_0 AS N'备注',
--		  T4.ZREMARK_0 AS N'客户备注',
--		  (CASE T2.CFMFLG_0 WHEN 1 THEN N'已审核' WHEN 2 THEN N'未审核' END)  AS N'发货单状态'
--FROM SDELIVERYD T1
--	 LEFT JOIN SDELIVERY T2 ON T1.SDHNUM_0 = T2.SDHNUM_0
--	 LEFT JOIN SORDERQ T3 ON T1.SOHNUM_0 = T3.SOHNUM_0 AND T1.SOPLIN_0 = T3.SOPLIN_0
--	 LEFT JOIN SORDER T4 ON T1.SOHNUM_0 = T4.SOHNUM_0
--WHERE T1.QTY_0 <> T3.QTY_0

SELECT * FROM SORDERQ
SELECT TOP 10 * FROM SORDERP
SELECT * FROM ZSOYN 
SELECT * FROM SDELIVERYD


SELECT T1.SOHNUM_0 AS N'销售订单号',
		T1.SOPLIN_0 / 1000 AS N'销售订单行号',
		T1.ITMREF_0 AS N'产品编码',
		T2.ITMDES1_0 AS N'产品名称',
		T1.BPCORD_0 AS N'客户代码',
		T3.BPCNAM_0 AS N'客户名称',
		T1.ORDDAT_0 AS N'订单日期',
		T1.CREDAT_0 AS N'创建日期',
		T1.SHIDAT_0 AS N'交期',
		T1.QTY_0 AS N'销售订单数量',
		T4.QTY_0 AS N'发货单数量',
		(CASE T8.CFMFLG_0 WHEN 1 THEN T1.QTY_0 - T4.QTY_0 ELSE 0 END)  AS N'发货中数量',
		T2.NETPRI_0 * T1.QTY_0 AS N'金额',
		T1.ZRMK_0 AS N'备注',
		T1.ZCUSNUM_0 AS N'客户订单号',
		T1.ZCUSNUMLIN_0 AS N'客户订单行号',
		T5.NOMUSR_0 AS N'创建人',
		T6.ITMDESBPC_0 AS N'客户产品号',
		T7.XSOHNUM_0 AS N'内部订单号',
		T7.XSOPLIN_0 / 1000 AS N'内部订单行号'
FROM SORDERQ T1
	LEFT JOIN SORDERP T2 ON T1.SOHNUM_0 = T2.SOHNUM_0 AND T1.SOPLIN_0 = T2.SOPLIN_0
	LEFT JOIN BPCUSTOMER T3 ON T1.BPCORD_0 = T3.BPCNUM_0
	LEFT JOIN SDELIVERYD T4 ON T1.SOHNUM_0 = T4.SOHNUM_0 AND T1.SOPLIN_0 = T4.SOPLIN_0
	LEFT JOIN AUTILIS T5 ON T1.CREUSR_0 = T5.USR_0
	LEFT JOIN ITMBPC T6 ON T1.ITMREF_0 = T6.ITMREF_0 AND T1.BPCORD_0 = T6.BPCNUM_0
	LEFT JOIN ZSOYN T7 ON T1.SOHNUM_0 = T7.SOHNUM_0 AND T1.SOPLIN_0 = T7.SOPLIN_0
	LEFT JOIN SDELIVERY T8 ON T4.SDHNUM_0 = T8.SDHNUM_0
WHERE T1.SOHNUM_0 = '0101SOH17010002'

SELECT * FROM SORDERQ WHERE SOHNUM_0 = '0101SOH17030088'
SELECT * FROM PORDERQ WHERE POHNUM_0 = '0101POH17030167'
SELECT * FROM SORDER WHERE SOHNUM_0 = '0101SOH17030087'
SELECT * FROM PORDER WHERE POHNUM_0 = '0101POH17030167'
SELECT * FROM ORDERS WHERE WIPNUM_0 = 'WIP01011703023795'
DELETE  FROM ORDERS WHERE WIPNUM_0 = 'WIP01011703023795'
SELECT * FROM SORDERP WHERE SOHNUM_0 = '0101SOH17030087'

















