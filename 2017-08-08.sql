SELECT T1.ITMREF_0,
		T2.ITMDES1_0,
		T1.MFGFCY_0,
		T1.QTY_0
FROM (
		SELECT ITMREF_0,
				MFGFCY_0,
				SUM(CPLQTY_0) QTY_0 
		FROM MFGITMTRK 
		WHERE ITMREF_0 NOT LIKE 'M%' 
			AND CONVERT(VARCHAR(10),CREDAT_0,120) = (CONVERT(VARCHAR(10),GETDATE() - 1,120))  
		GROUP BY ITMREF_0,MFGFCY_0
		) T1 
LEFT JOIN ITMMASTER T2 ON T1.ITMREF_0 = T2.ITMREF_0
ORDER BY T1.ITMREF_0


SELECT T1.SOHNUM_0,
						T1.SOPLIN_0 / 1000,
						T1.BPCORD_0,
						T2.BPCNAM_0,
						T1.ITMREF_0,
						T1.QTY_0,
						T1.DLVQTY_0,
						(T1.QTY_0 - T1.DLVQTY_0) NEDQTY_0,
						T3.REP_0
				FROM SORDERQ T1 
					LEFT JOIN BPCUSTOMER T2 ON T1.BPCORD_0 = T2.BPCNUM_0
					LEFT JOIN SORDER T3 ON T1.SOHNUM_0 = T3.SOHNUM_0
SELECT * FROM SORDER WHERE SOHNUM_0 = '0101SOH17070446'


SELECT * FROM SDELIVERYD WHERE SDHNUM_0 = '0101SDH17080123'
SELECT * FROM SDELIVERY WHERE SDHNUM_0 = '0101SDH17080123'
SELECT ITMREF_0,COUNT(ITMREF_0) FROM ITMFACILIT GROUP BY ITMREF_0
SELECT CREUSR_0,LASINVNUM_0,* FROM SORDER WHERE REP_0 = '' AND SALFCY_0 = 0101 AND CREUSR_0 NOT IN('ADMIN','ALAN')
SELECT * FROM AUTILIS WHERE USR_0 = '0011'
UPDATE SORDER SET REP_0 = 'D008' WHERE  REP_0 = '' AND SALFCY_0 = 0101 AND CREUSR_0 = '0011'

SELECT * FROM SORDER WHERE REP_0 = '0010'

SELECT ITMREF_0,CTMBPSFLG_0,COUNT(ITMREF_0) FROM ITMBPS GROUP BY ITMREF_0, CTMBPSFLG_0 HAVING COUNT(ITMREF_0) >1 AND CTMBPSFLG_0 = 1
SELECT * FROM ITMBPS
SELECT * FROM BPSUPPLIER
SELECT TOP 100 * FROM SINVOICE
SELECT * FROM SORDER
SELECT * FROM BPARTNER


SELECT T1.CREUSR_0,
		T1.SOHNUM_0,
		T3.NOMUSR_0,
		T4.BPRNUM_0
FROM SORDER T1
	LEFT JOIN SDELIVERY T2  ON T1.LASDLVNUM_0 = T2.SDHNUM_0
	LEFT JOIN AUTILIS T3 ON T2.CREUSR_0 = T3.USR_0
	LEFT JOIN BPARTNER T4 ON T3.NOMUSR_0 = T4.BPRNAM_0
WHERE T1.REP_0 = '' 
	AND T1.SALFCY_0 = 0101
	AND T4.BPRNUM_0 IS NOT NULL
	AND T4.BPRNUM_0 NOT IN('D009','D114')



SELECT T1.ITMREF_0,
		T2.ITMDES1_0,
		T1.MFGFCY_0,
		T1.QTY_0
FROM (
		SELECT ITMREF_0,
				MFGFCY_0,
				SUM(CPLQTY_0) QTY_0 
		FROM MFGITMTRK 
		WHERE CONVERT(VARCHAR(10),CREDAT_0,120) = (CONVERT(VARCHAR(10),GETDATE() - 1,120))  
		GROUP BY ITMREF_0,MFGFCY_0
		) T1 
LEFT JOIN ITMMASTER T2 ON T1.ITMREF_0 = T2.ITMREF_0
WHERE T1.MFGFCY_0 = '0201'
ORDER BY T1.ITMREF_0

SELECT T1.ITMREF_0,
		T2.ITMDES1_0,
		T1.STOFCY_0,
		T1.QTY_0
FROM
	(
		SELECT ITMREF_0,
				STOFCY_0,
				SUM(QTY_0) QTY_0
		FROM SDELIVERYD
		WHERE CONVERT(VARCHAR(10),CREDAT_0,120) = (CONVERT(VARCHAR(10),GETDATE() - 1,120))  
		GROUP BY ITMREF_0,STOFCY_0
		) T1
	LEFT JOIN ITMMASTER T2 ON T1.ITMREF_0 = T2.ITMREF_0
WHERE T1.STOFCY_0 = '0201'
ORDER BY T1.ITMREF_0,T1.STOFCY_0


SELECT * 
FROM PORDERQ
WHERE POHNUM_0 IN(SELECT POHNUM_0 FROM SORDERQ WHERE SALFCY_0 <> '0101' AND SDHNUM_0 ='')
	AND ITMREF_0 IN('ICH2395-112','ICH2395-48','ICH2395-LA001','ICH2398-112','ICH2398-48','ICS0063','ICT2798-26','ICT2995-20','ICT2998-20','ICT5600-02','ICT6330-73','ICZ6087','IZF0045','MCT6230')

SELECT TOP 1000 * FROM SDELIVERYD
SELECT TOP 1000 * FROM SORDERQ
SELECT TOP 1000 * FROM PORDERQ
SELECT TOP 1000 * FROM PRECEIPTD

SELECT T1.POHNUM_0,
		T1.ITMREF_0,
		T1.QTYPUU_0,
		T3.QTY_0,
		T4.QTYSTU_0
FROM PORDERQ T1
	LEFT JOIN SORDERQ T2 ON T1.POHNUM_0 = T2.POHNUM_0 AND T1.POPLIN_0 = T2.POPLIN_0
	LEFT JOIN (
				SELECT SOHNUM_0,
						SOPLIN_0,
						ITMREF_0,
						SUM(QTY_0) QTY_0 
				FROM SDELIVERYD 
				WHERE CONVERT(VARCHAR(10),CREDAT_0,120) = (CONVERT(VARCHAR(10),GETDATE() - 1,120))  
				GROUP BY SOHNUM_0,SOPLIN_0,ITMREF_0
				) T3 ON T2.SOHNUM_0 = T3.SOHNUM_0 
						AND T2.SOPLIN_0 = T3.SOPLIN_0
	LEFT JOIN (
				SELECT POHNUM_0,
						POPLIN_0,
						ITMREF_0,
						SUM(QTYSTU_0) QTYSTU_0 
				FROM PRECEIPTD 
				WHERE CONVERT(VARCHAR(10),CREDAT_0,120) = (CONVERT(VARCHAR(10),GETDATE() - 1,120))  
				GROUP BY POHNUM_0,POPLIN_0,ITMREF_0
				) T4 ON T1.POHNUM_0 = T4.POHNUM_0 
						AND T1.POPLIN_0 = T4.POPLIN_0
WHERE T1.POHFCY_0 = '0101'
	AND LEFT(T1.BPSNUM_0, 3) = 'YN-'
	AND ((T1.QTYPUU_0 - T4.QTYSTU_0) > 0 OR T4.POHNUM_0 IS NULL)
	AND T3.QTY_0 IS NOT NULL
	AND T1.ITMREF_0 IN('ICH2395-112','ICH2395-48','ICH2395-LA001','ICH2398-112','ICH2398-48','ICS0063','ICT2798-26','ICT2995-20','ICT2998-20','ICT5600-02','ICT6330-73','ICZ6087','IZF0045','MCT6230')

SELECT * FROM PRECEIPTD WHERE POHNUM_0 = '0101POH17020881' AND ITMREF_0 = 'ICT5600-02' ORDER BY PTHNUM_0
SELECT * FROM SDELIVERYD 



SELECT T1. SDHNUM_0,
		T1.ITMREF_0,
		T3.ITMDES1_0,
		T1.QTY_0,
		T1.RCPQTYSTU_0,
		T2.POHNUM_0,
		T4.QTYPUU_0
FROM SDELIVERYD T1
	LEFT JOIN SORDERQ T2 ON T1.SOHNUM_0 = T2.SOHNUM_0 AND T1.SOPLIN_0 = T2.SOPLIN_0
	LEFT JOIN ITMMASTER T3 ON T1.ITMREF_0 = T3.ITMREF_0
	LEFT JOIN PORDERQ T4 ON T2.POHNUM_0 = T4.POHNUM_0 AND T2.POPLIN_0 = T4.POPLIN_0
WHERE CONVERT(VARCHAR(10),T1.CREDAT_0,120) = (CONVERT(VARCHAR(10),GETDATE() - 1,120)) 
	AND T1.STOFCY_0 <> '0101'
	AND T1.RCPQTYSTU_0 <> T1.QTY_0
	AND T1.ITMREF_0 IN('ICH2395-112','ICH2395-48','ICH2395-LA001','ICH2398-112','ICH2398-48','ICS0063','ICT2798-26','ICT2995-20','ICT2998-20','ICT5600-02','ICT6330-73','ICZ6087','IZF0045','MCT6230')




