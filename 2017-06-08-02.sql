--SELECT * FROM SDELIVERYD
--SELECT * FROM SDELIVERY
--SELECT * FROM ITMCOST
--SELECT VAT_0,* FROM SORDERP








SELECT T1.CREDAT_0 N'制单日期',
		T2.BPCORD_0 N'客户编码',
		T2.BPDNAM_0 N'客户名称',
		T1.SDHNUM_0 N'发货单号',
		T2.DLVDAT_0 N'发货日期',
		T1.SDDLIN_0 N'发货行号',
		T1.ITMREF_0 N'产品编码',
		T1.ITMDES_0 N'产品名称',
		T1.SAU_0 N'单位',
		T1.QTY_0 N'发货数量',
		T1.GROPRI_0 N'发货单价',
		(T1.QTY_0 * T1.GROPRI_0) N'发货价格',
		T3.MATCST_0 N'发货成本',
		T1.YINVQTY_0 N'已开票数量',
		T4.GROPRI_0 N'开票单价',
		((T1.QTY_0 - T1.YINVQTY_0) * T1.GROPRI_0) N'发出成本',
		T5.GROPRI_0 N'销售单价',
		(RIGHT(T7.VAT_0,2)) N'税率',
		T1.QTY_0 - T1.YINVQTY_0 N'未开票数量',
		(T1.QTY_0 - T1.YINVQTY_0) * T7.GROPRI_0 N'未开票金额'
FROM SDELIVERYD T1
	LEFT JOIN SDELIVERY T2 ON T1.SDHNUM_0 = T2.SDHNUM_0
	LEFT JOIN ITMCOST T3 ON T1.STOFCY_0 = T3.STOFCY_0 AND T1.ITMREF_0 = T3.ITMREF_0 AND T3.FIYNUM_0 = '2'
	LEFT JOIN SINVOICED T4 ON T1.YSIHNUM_0  =T4.NUM_0 AND T1.ITMREF_0 = T4.ITMREF_0
	LEFT JOIN SORDERP T5 ON T1.SOHNUM_0 = T5.SOHNUM_0 AND T1.SOPLIN_0 = T5.SOPLIN_0
	LEFT JOIN SORDER T6 ON T1.SOHNUM_0 = T6.SOHNUM_0
	LEFT JOIN SORDERP T7 ON T1.SOHNUM_0 = T7.SOHNUM_0 AND T1.SOPLIN_0 = T7.SOPLIN_0
WHERE T1.SDHNUM_0 = '0101SDH17030558'








