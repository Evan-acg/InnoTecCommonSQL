
SELECT * FROM AUTILIS ORDER BY USR_0
SELECT TOP 1000 * FROM SORDERQ
SELECT TOP 1000 * FROM SORDERP




SELECT T7.BPCORD_0 N'客户编码',
		T6.BPCNAM_0 N'客户名称',
		T7.AMOUNT N'销售金额'
FROM 
	(
		SELECT T9.BPCORD_0,
				SUM(T9.AMOUNT) AMOUNT	
		FROM 
			(
				SELECT T2.BPCORD_0,
						T1.GROPRI_0 * T2.QTY_0 AS AMOUNT
				FROM SORDERP T1
					LEFT JOIN SORDERQ T2 ON T1.SOHNUM_0 = T2.SOHNUM_0 AND T1.SOPLIN_0 = T2.SOPLIN_0 
				WHERE T1.SALFCY_0 = '0101'
					AND (
						T1.CREUSR_0 IN('0025','0026','0009','0010')
						OR T1.REP1_0 IN('D001','D002','')
							)
				) T9
		GROUP BY T9.BPCORD_0
		) T7
	LEFT JOIN BPCUSTOMER T6 ON T7.BPCORD_0 = T6.BPCNUM_0




SELECT T3.BPCINV_0,
		SUM(T3.AMOUNT) 
FROM
	(SELECT T1.BPCINV_0,
			T2.QTY_0 * T1.GROPRI_0 AMOUNT
	FROM SORDERP T1
		LEFT JOIN SORDERQ T2 ON T1.SOHNUM_0 = T2.SOHNUM_0 AND T1.SOPLIN_0 = T2.SOPLIN_0
	WHERE T2.SALFCY_0 = '0101') T3
GROUP BY T3.BPCINV_0