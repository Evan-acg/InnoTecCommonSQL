CREATE VIEW TEST
AS
SELECT T1.MFGNUM_0 AS N'工单号',
		T2.ITMREF_0 AS N'产品',
		T1.ITMREF_0 AS N'组件',
		T1.STU_0 AS N'单位',
		T1.RETQTY_0 AS N'需求数量',
		T1.YREQQTY_0 AS N'已申领数量',
		T1.SHTQTY_0 AS N'短缺数量' 
FROM (SELECT MFGNUM_0,ITMREF_0,STU_0,RETQTY_0,YREQQTY_0,SHTQTY_0,PLNFCY_0,MFGLIN_0 FROM MFGMAT)T1
	LEFT JOIN MFGITM T2 ON T1.MFGNUM_0 = T2.MFGNUM_0 AND T2.MFGLIN_0 = 1000
WHERE T1.PLNFCY_0 = '0202'
	AND T1.MFGNUM_0 IN (SELECT DISTINCT MFGNUM_0 
						FROM MFGITM 
						WHERE MFGFCY_0 = '0202' 
							AND CPLQTY_0 >= EXTQTY_0)
	AND T1.SHTQTY_0 > 0

SELECT * FROM TEST
DROP VIEW TEST
sp_helptext TEST

SELECT * FROM SORDERQ WHERE SOHNUM_0 = '0101SOH17040150'
SELECT * FROM PORDERQ WHERE SOHNUM_0 = '0101SOH17040150'
SELECT * FROM SORDERQ WHERE POHNUM_0 = '0101POH17040233'
SELECT * FROM SORDERQ WHERE SALFCY_0 = '0101' AND POHNUM_0 = ''

SELECT * FROM SORDER WHERE SOHNUM_0 = '0101SOH17040150'
SELECT * FROM SORDERP WHERE SOHNUM_0 = '0101SOH17040150'

--UPDATE SORDERQ SET FMINUM_0 = '0101POH17040233',FMILIN_0 = 1000,POHNUM_0 = '',POPLIN_0 = 0 WHERE SOHNUM_0 = '0101SOH17040150'


SELECT * FROM SDELIVERY WHERE SDHNUM_0 = '0201SDI17040163'
SELECT * FROM STOALL WHERE VCRNUM_0 = '0201SDI17040163'

--DELETE FROM STOALL WHERE VCRNUM_0 = '0201SDI17040163'

SELECT T2.SOHNUM_0,
		T2.POHNUM_0,
		T1.SOHNUM_0,
		T1.ITMREF_0,
		T1.QTY_0
FROM SORDERQ T1
	LEFT JOIN PORDERQ T2 ON T1.POHNUM_0 = T2.POHNUM_0 AND T1.POPLIN_0 = T2.POPLIN_0
WHERE T1.SOHNUM_0 = '0201SOH17020375'

SELECT * FROM SORDERQ WHERE ITMREF_0 = 'ICT2058-03' AND QTY_0 = 1269
SELECT * FROM SDELIVERYD WHERE ITMREF_0 = 'ICT2058-03' AND SOHNUM_0 = '0201SOH17040216'

--DELETE FROM SORDERQ WHERE SOHNUM_0 = '0201SOH17040216'
--DELETE FROM SORDER WHERE SOHNUM_0 = '0201SOH17040216'
--DELETE FROM SORDERP WHERE SOHNUM_0 = '0201SOH17040216'

SELECT * FROM SDELIVERYD WHERE SOHNUM_0 = '0201SOH17040241'
SELECT * FROM AUTILIS WHERE USR_0 = '0076'


SELECT QTY_0,* FROM SORDERQ WHERE ITMREF_0 = 'ISQ0070-05'


SELECT * FROM PRECEIPTD WHERE PTHNUM_0 = '02011704RCI00000007'

SELECT * FROM SORDERQ WHERE SOHNUM_0 = '0202SOH17040088'

SELECT * FROM AUDITH WHERE ID1_0 = '0202SOH17020203'


SELECT * FROM SINVOICE WHERE NUM_0 = '0101SIH17030142'
SELECT * FROM XINVOICER

CREATE VIEW SUN
AS
	SELECT T1.NUM_0 N'发票号',
			T3.BPCNAM_0 N'客户',
			T2.XGTAXAMT_0 N'发票金额',
			T2.XGTAXNUM_0 N'金税票号',
			T2.XGTAXDAT_0 N'金税日期'
	FROM SINVOICE T1
		LEFT JOIN XINVOICER T2 ON T1.NUM_0 = T2.NUM_0
		LEFT JOIN BPCUSTOMER T3 ON T1.BPR_0 = T3.BPCNUM_0
SELECT * FROM SUN





