SELECT  C.BPR_0 AS 客户编码,
		C.BPRNAM_0 AS 客户名称,
		C.ACCDAT_0 AS 发票日期,
		C.CUR_0 AS 币种,
		C.RATMLT_0 AS 汇率,
		A.NUM_0 AS 发票号,
		A.SIDLIN_0 AS 发票行,
		A.SDHNUM_0 AS 发货单号,
		A.SDDLIN_0 AS 发货行,
		A.ITMREF_0 AS 物料号,
		A.ITMDES1_0 AS 产品描述,
		CASE WHEN C.SIVTYP_0='CNINC' THEN A.QTYSTU_0 ELSE A.QTYSTU_0*-1 END  AS 数量,
		A.NETPRI_0*C.RATMLT_0 AS 发票含税价RMB,
		A.NETPRINOT_0*C.RATMLT_0 AS 发票价RMB,
		B.CPRPRI_0 AS 成本价RMB,
		CASE WHEN C.SIVTYP_0='CNINC' THEN C.RATMLT_0*A.AMTNOTLIN_0 ELSE C.RATMLT_0*A.AMTNOTLIN_0*-1 END AS 发票金额RMB,
		A.DISCRGVAL1_0
FROM SINVOICED  A 
	LEFT JOIN ZSCOST B ON A.SDHNUM_0=B.SDHNUM_0 AND A.SDDLIN_0=B.SDDLIN_0
	INNER JOIN SINVOICE C ON A.NUM_0=C.NUM_0
WHERE C.ACCDAT_0 BETWEEN '2018-2-01' AND '2018-2-28'
		AND C.FCY_0='0101'

SELECT TOP 100 * FROM SINVOICED WHERE NUM_0 = N'0101SIH18020046'

SELECT * FROM ORDERS WHERE ITMREF_0 = N'ITY2086' AND STOFCY_0 = N'0203'
DELETE FROM ORDERS WHERE ITMREF_0 = N'ITY2086' AND STOFCY_0 = N'0203'


SELECT * FROM STOJOU WHERE ITMREF_0 = N'MCZ0630' AND STOFCY_0 = N'0102' ORDER BY CREDAT_0

SELECT TOP 100 * FROM STOCK
SELECT STOFCY_0,
		ITMREF_0,
		STA_0,
		SUM(QTYSTU_0) QTYSTU_0
FROM STOCK
GROUP BY ITMREF_0,STOFCY_0,STA_0

SELECT T1.ITMREF_0 N'产品编码',
		T2.ITMDES1_0 N'产品名称',
		T2.STU_0 N'产品单位',
		T3.LOC_0 N'库位',
		T3.STA_0 N'产品状态',
		T3.QTYSTU_0 N'库存数量'
FROM ITMFACILIT T1
	LEFT JOIN ITMMASTER T2 ON T1.ITMREF_0 = T2.ITMREF_0
	LEFT JOIN (SELECT STOFCY_0,
						ITMREF_0,
						STA_0,
						LOC_0,
						SUM(QTYSTU_0) QTYSTU_0
				FROM STOCK
				GROUP BY ITMREF_0,STOFCY_0,STA_0,LOC_0
				) T3 
				ON T1.ITMREF_0 = T3.ITMREF_0 AND T1.STOFCY_0 = T3.STOFCY_0
WHERE T1.STOFCY_0 = N'0201'

SELECT TOP 100 * FROM SORDERQ 
SELECT TOP 100 * FROM MFGMAT
SELECT TOP 100 * FROM PORDERQ
SELECT T1.ITMREF_0 N'产品编码',
		T2.ITMDES1_0 N'产品名称',
		T3.QTYSTU_0 N'A状态库存',
		T4.QTY_0 N'销售订单需求',
		T5.RETQTY_0 N'工单需求',
		T6.QTYSTU_0 N'采购订单在途'
FROM ITMFACILIT T1
	LEFT JOIN ITMMASTER T2 ON T1.ITMREF_0 = T2.ITMREF_0
	LEFT JOIN (SELECT  STOFCY_0,
						ITMREF_0,
						SUM(QTYSTU_0) QTYSTU_0
				FROM STOCK 
				WHERE STA_0 = N'A'
				GROUP BY ITMREF_0,STOFCY_0
				) T3 
				ON T1.ITMREF_0 = T3.ITMREF_0 AND T1.STOFCY_0 = T3.STOFCY_0
	LEFT JOIN (SELECT STOFCY_0,
						ITMREF_0,
						SUM(QTY_0) QTY_0 
			   FROM SORDERQ 
			   WHERE SOQSTA_0 < 3 
			   GROUP BY STOFCY_0,ITMREF_0
			   ) T4 
			   ON T1.STOFCY_0 = T4.STOFCY_0 AND T1.ITMREF_0 = T4.ITMREF_0
	LEFT JOIN (SELECT MFGFCY_0,
						ITMREF_0,
						SUM(RETQTY_0) RETQTY_0 
				FROM MFGMAT 
				WHERE RETQTY_0 - USEQTY_0 > 0 AND MATSTA_0 < 3 
				GROUP BY MFGFCY_0,ITMREF_0
				) T5 
				ON T1.STOFCY_0 = T5.MFGFCY_0 AND T1.ITMREF_0 = T5.ITMREF_0
	LEFT JOIN (SELECT POHFCY_0,
						ITMREF_0,
						SUM(QTYSTU_0) QTYSTU_0 
				FROM PORDERQ 
				WHERE QTYSTU_0 - RCPQTYSTU_0 > 0 AND LINCLEFLG_0 =1
				GROUP BY POHFCY_0,ITMREF_0
				) T6 
				ON T1.STOFCY_0 = T6.POHFCY_0 AND T1.ITMREF_0 = T6.ITMREF_0
WHERE T1.STOFCY_0 = N'0201'


SELECT TOP 1000 * FROM MFGHEAD
SELECT * FROM MFGITM WHERE VCRNUMORI_0 = ''
SELECT TOP 1000 * FROM MFGMAT
SELECT TOP 1000 * FROM MFGHEAD

SELECT * FROM SDELIVERYD WHERE SDHNUM_0 = N'0101SDH18030484'
SELECT LINNBR_0,* FROM SDELIVERY WHERE SDHNUM_0 = N'0101SDH18030484'
UPDATE SDELIVERY SET LINNBR_0 = 6 WHERE SDHNUM_0 = N'0101SDH18030484'


SELECT * FROM PORDERQ WHERE ITMREF_0 = N'ICN0004-217'


SELECT * FROM SDELIVERYD WHERE SDHNUM_0 = N'0203SDI18040131'
SELECT * FROM SORDERQ WHERE SOHNUM_0 = N'0203SOH18040025'
SELECT * FROM PORDERQ WHERE POHNUM_0 = N'0201POH18030233'

SELECT T1.SDHNUM_0,
		T1.SDDLIN_0,
		T2.SOHNUM_0,
		T2.SOPLIN_0,
		T3.POHNUM_0,
		T3.POPLIN_0
FROM SDELIVERYD T1
	LEFT JOIN SORDERQ T2 ON T1.SOHNUM_0 = T2.SOHNUM_0 AND T1.SOPLIN_0 = T2.SOPLIN_0
	LEFT JOIN PORDERQ T3 ON T2.POHNUM_0 = T3.POHNUM_0 AND T2.POPLIN_0 = T3.POPLIN_0
WHERE T1.SDHNUM_0 = N'0203SDI18040131'
	AND T1.ITMREF_0 = N'ITY0052'


SELECT MTOQTY_0,* FROM ORDERS WHERE VCRNUM_0 = N'0202SOH18040079' AND ITMREF_0 = N'IHQ0219'
UPDATE ORDERS SET MTOQTY_0 = 0 WHERE VCRNUM_0 = N'0202SOH18040079' AND ITMREF_0 = N'IHQ0219'


SELECT * FROM SORDER WHERE SOHNUM_0 = N'0101SOH18030458'
SELECT * FROM CONTACT WHERE BPANUM_0 = N'CHN-ZJ-4588'
SELECT * FROM CONTACTCRM WHERE CNTNUM_0 = N'C0380'
SELECT * FROM BPCBPA

SELECT TOP 1000 * FROM SORDER


SELECT TOP 1000 * FROM MFGITM

SELECT TOP 1000 * FROM MFGHEAD WHERE MFGNUM_0 = N'0201MFG18041089'

SELECT MTC_0,BPR_0,* FROM GACCENTRYD WHERE NUM_0='0101SIH18040067'

DELETE FROM TRCVCRDOC WHERE NUM_0='0101SIH18040067';
UPDATE GACCENTRY SET ORIMOD_0=2,FLGGEN_0=1 WHERE NUM_0='0101SIH18040067';
UPDATE SINVOICE SET STA_0=1 WHERE NUM_0='0101SIH18040067';
UPDATE SINVOICEV SET INVSTA_0=1 WHERE NUM_0='0101SIH18040067';



SELECT TOP 100 * FROM MFGOPE WHERE POHNUM_0 = N'0201POH18030233'

SELECT * FROM BPDLVCUST WHERE BPCNUM_0 = N'CHN-JS-4867'



SELECT  C.BPR_0 AS 客户编码,
		C.BPRNAM_0 AS 客户名称,
		C.ACCDAT_0 AS 发票日期,
		C.CUR_0 AS 币种,
		C.RATMLT_0 AS 汇率,
		A.NUM_0 AS 发票号,
		A.SIDLIN_0 AS 发票行,
		A.SDHNUM_0 AS 发货单号,
		A.SDDLIN_0 AS 发货行,
		A.ITMREF_0 AS 物料号,
		A.ITMDES1_0 AS 产品描述,
		CASE WHEN C.SIVTYP_0='CNINC' THEN A.QTYSTU_0 ELSE A.QTYSTU_0*-1 END  AS 数量,
		A.NETPRI_0*C.RATMLT_0 AS 发票含税价RMB,
		A.NETPRINOT_0*C.RATMLT_0 AS 发票价RMB,
		B.CPRPRI_0 AS 成本价RMB,
		CASE WHEN C.SIVTYP_0='CNINC' THEN C.RATMLT_0*A.AMTNOTLIN_0 ELSE C.RATMLT_0*A.AMTNOTLIN_0*-1 END AS 发票金额RMB,
		A.DISCRGVAL1_0 AS N'减扣（金额减少）',
		A.DISCRGVAL3_0 AS N'杂费(金额增加)',
        A.YNOTE_0 AS N'备注'
FROM SINVOICED  A 
	LEFT JOIN ZSCOST B ON A.SDHNUM_0=B.SDHNUM_0 AND A.SDDLIN_0=B.SDDLIN_0 
	INNER JOIN SINVOICE C ON A.NUM_0=C.NUM_0
WHERE C.ACCDAT_0 BETWEEN '2018-2-01' AND '2018-2-28'
		AND C.FCY_0='0101'


SELECT * FROM SINVOICED AND

UPDATE BPDLVCUST SET STOFCY_0 = N'0102' WHERE BPCNUM_0 IN(N'CHN-JS-4867',N'CHN-HEN-4868',N'CHN-HUB-4869',N'CHN-HUB-4870',N'CHN-SD-4872',N'CHN-HUB-4871',N'CHN-SD-4874',N'CHN-SD-4875',N'CHN-ZJ-4881',N'CHN-SD-4876',N'CHN-JS-4883',N'CHN-HEN-4886',N'CHN-SD-4877',N'CHN-SD-4878',N'CHN-HLJ-4890',N'CHN-SC-4895',N'CHN-HUN-4830',N'CHN-HEN-4835',N'CHN-HEB-4837',N'CHN-JS-4841',N'CHN-FJ-4832',N'CHN-ZJ-4834',N'CHN-SX-4732',N'CHN-HEB-4838',N'CHN-LN-4840',N'CN-LN-8154',N'CHN-LN-4841',N'CHN-HLJ-4842',N'CHN-JX-4843',N'CHN-YN-4896',N'CHN-YN-4899',N'CHN-HEN-4897',N'CHN-GX-4902',N'CHN-SC-4904',N'CHN-HEN-4905',N'CHN-SD-4907',N'CHN-SD-4913',N'CHN-SD-4914',N'CHN-JS-4900',N'CHN-JL-4919',N'CHN-SC-4858',N'CHN-HUB-4845',N'CHN-HLJ-4848',N'CHN-NMG-4849',N'CHN-HEN-4850',N'CHN-LN-4855',N'CHN-HLJ-8155',N'CHN-GD-4859',N'CHN-JS-4861',N'CHN-HUN-4862',N'CHN-AH-4578',N'CHN-AH-4770',N'CHN-HUB-4741',N'CHN-HUN-4729',N'CHN-GD-4738',N'CHN-SD-4764',N'CHN-JS-4771',N'CHN-NX-4703',N'CHN-JL-4697',N'CHN-GD-4745',N'CHN-BJ-4743',N'CHN-SC-4774',N'CHN-AH-4775',N'CHN-SC-4776',N'CHN-HEB-4781',N'CHN-JS-4782',N'CHN-SD-471
4',N'CHN-NMG-4786',N'CHN-JS-4754',N'CHN-SX-4790',N'CHN-JS-4796',N'CHN-GD-4349',N'CHN-GD-4504',N'CHN-GD-4593',N'CHN-GD-4677',N'CHN-GD-4685',N'CHN-GZ-4045',N'CHN-HEB-4498',N'CHN-HEN-4041',N'CHN-HLJ-4607',N'CHN-HN-4525',N'CHN-HUB-4318',N'CHN-HUB-4407',N'CHN-HUN-4597',N'CHN-JL-4426',N'CHN-JL-4440',N'CHN-JS-4416',N'CHN-JS-4460',N'CHN-JS-4553',N'CHN-JS-4563',N'CHN-JS-4571',N'CHN-JS-4659',N'CHN-JS-8056',N'CHN-JX-4679',N'CHN-JX-4682',N'CHN-LN-4441',N'CHN-SD-4159',N'CHN-SD-4222',N'CHN-SD-4346',N'CHN-SD-4515',N'CHN-CQ-4740',N'CHN-FJ-4715',N'CHN-SH-4465',N'CHN-NMG-4731',N'CHN-HEB-4742',N'CHN-SH-4678',N'CHN-SX-4531',N'CHN-YN-4687',N'CHN-ZJ-4174',N'CHN-ZJ-4423',N'CHN-ZJ-4463',N'CHN-GD-4809',N'CHN-SX-4736',N'CHN-AH-4814',N'CHN-GD-4818',N'CHN-GD-4819',N'CHN-LN-4712',N'CHN-HEB-4695',N'CHN-HEB-4747',N'CHN-TJ-4692',N'CHN-SHX-4707',N'CHN-XJ-4705',N'CHN-JS-4757',N'CHN-JS-4763',N'CHN-HUN-4746',N'CHN-JS-4762',N'CHN-GZ-4737',N'CHN-GZ-4751',N'CHN-FJ-4725',N'CHN-SD-4716',N'CHN-HLJ-4806',N'CHN-GD-4812',N'CHN-GD-4816',N'CHN-NMG-4817',
N'CHN-SHX-4821',N'CHN-JX-4822',N'CHN-SC-4777',N'CHN-JS-4778',N'CHN-SX-4788',N'CHN-HUN-4783',N'CHN-FJ-4784',N'CHN-SHX-4785',N'CHN-JS-4789',N'CHN-SC-4791',N'CHN-HEN-4792',N'CHN-JS-4793',N'CHN-HUB-4794',N'CHN-HEN-4795',N'CHN-XS-4799',N'CHN-LN-4802',N'CHN-HEN-4713',N'CHN-HEN-4803',N'CHN-JL-4804',N'CHN-HLJ-4798',N'CHN-CQ-4800',N'CHN-HUB-4801',N'CHN-HUB-4805',N'CHN-GD-4820',N'CHN-JL-4825',N'CHN-SC-4823',N'CHN-HN-4749',N'CNH-ZJ-4826',N'CHN-ZJ-4827',N'CHN-HUB-4828',N'CHN-LN-8156',N'CHN-HEB-4865',N'CHN-GD-4866',N'CHN-SD-4915',N'CHN-JS-4916',N'CHN-GD-4910',N'CHN-FJ-4911',N'CHN-SD-4912',N'CHN-JS-4917',N'CHN-JS-4921',N'CHN-HUN-4920',N'CHN-FJ-4923',N'CHN-GD-4925',N'CHN-JS-4924',N'CHN-GD-4929',N'CHN-FJ-4930',N'CHN-GD-4931',N'CHN-TJ-4932',N'CHN-SX-4933',N'CHN-SD-4933',N'CHN-LN-4935',N'CHN-SH-4936',N'CHN-SD-4938',N'CHN-HLJ-4939',N'CHN-JS-4937',N'CHN-JS-4947',N'CHN-JS-4943',N'CHN-QH-4946',N'CHN-GD-4940',N'CHN-JS-4955',N'CHN-LN-4956',N'CHN-HEB-4944',N'CHN-SHX-4948',N'CHN-JS-4950',N'CHN-GS-4951',N'CHN-GD-4953',N'CHN-HUB-4954',
N'CHN-GD-4958',N'CHN-GD-4335',N'CHN-JL-4016',N'CHN-JS-4550',N'CHN-HLJ-4962',N'CHN-NMG-4963',N'CHN-NX-4964')

